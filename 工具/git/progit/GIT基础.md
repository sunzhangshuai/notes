# GIT基础

## 版本控制系统

1. 可以将选定的文件回溯到之前的状态；
2. 将整个项目都回退到过去某个时间点的状态；
3. 可以比较文件的变化细节，查出最后是谁修改了哪个地方，从而找出导致怪异问题出现的原因；
4. 可以看出谁在何时报告了某个功能缺陷等等。

### 本地版本控制系统

采用某种简单的数据库来记录文件的历次更新差异。

RCS

### 集中化版本控制系统

有一个单一的集中管理的服务器，保存所有文件的修订版本，而协同工作的人们都通过客户端连到这台服务器，取出最新的文件或者提交更新。 

#### 缺点

1. 中央服务器的单点故障。 如果宕机一小时，那么在这一小时内，谁都无法提交更新，也就无法协同工作。
2. 中心数据库所在的磁盘发生损坏，又没有做恰当备份，你将丢失所有数据——包括项目的整个变更历史。

### 分布式版本控制系统

1. 客户端并不只提取最新版本的文件快照， 而是把代码仓库完整地镜像下来，包括完整的历史记录。 
2. 每一次的克隆操作，实际上都是一次对代码仓库的完整备份。
3. 任何一处协同工作用的服务器发生故障，事后都可以用任何一个镜像出来的本地仓库恢复。

## GIT特性

1. **直接记录快照，而非差异比较。**

   ![git快照.png](imgs/git快照.png)

   1. Git 像是把数据看作是对小型文件系统的一系列快照。
   2. 每当提交更新或保存项目状态时，基本上就会对当时的全部文件创建一个快照并保存这个快照的索引。
   3. 如果文件没有修改，Git 不再重新存储该文件，而是只保留一个链接指向之前存储的文件。

2. **近乎所有操作都本地执行**

3. **git保证完整性**

   1. Git 中所有的数据在存储前都计算校验和，然后以校验和来引用。 
   2. 不可能在 Git 不知情时更改任何文件内容或目录内容。 
   3. Git 用以计算校验和的机制叫做 SHA-1 散列（hash，哈希）。这是一个由 40 个十六进制字符（0-9 和 a-f）组 成的字符串。
   4. 基于 Git 中**文件的内容或目录结构**计算出来。

4. **git一般只添加数据**

    Git 几乎不会执行任何可能导致文件不可恢复的操作。

5. **git拥有三种状态和三个阶段**

   ![git状态.png](imgs/git状态.png)

   1. 三种状态
      1. 已修改【modified】：表示修改了文件，但还没保存到数据库中。
      2. 已暂存【staged】：表示对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中。
      3. 已提交【committed】：表示数据已经安全的保存在本地数据库中。
   2. 三个阶段
      1. 工作区：是对项目的某个版本独立提取出来的内容。从 Git 仓库的压缩数据库中提取出来的文件，放在磁盘上供你使用或修改。
      2. 暂存区：是一个文件，保存了下次将要提交的文件列表信息，一般在 Git 仓库目录中。 Git 的术语叫做「索引」。
      3. git目录： Git 用来保存项目的元数据和对象数据库的地方。 从其它计算机克隆仓库时，复制的就是这里的数据。 

## GIT初配置

### 查看git版本

```shell
git --version
```

### git config

设置控制 Git 外观和行为的配置变量。

1. `/etc/gitconfig` 文件：包含系统上每一个用户及他们仓库的通用配置。--system 选项会读写该文件中的配置变量。
2. `~/.gitconfig` 或 `~/.config/git/config` 文件：只针对当前用户。--global 选项会读写该文件中的配置变量。
3. 项目中的 ` .git/config` 文件：针对该仓库。 默认用这个。--local。

每个级别会覆盖上一级别的配置。

#### 查看所有配置以及它们所在的文件

```shell
git config --list --show-origin
```

#### 用户信息

1. 必须设置用户名和邮件地址。
2. 会写入到每一次提交中，不可更改。

```shell
# 最小配置
git config [--local|--global|--system] user.name your_name
git config [--local|--global|--system] user.email XXX@XXX.com
```

#### 文本编辑器

当 Git 需要你输入信息时会调用它。 如果未配置，Git 会使用操作系统默认的文本编辑器【vim】。 

```shell
git config --global core.editor 编辑器
```

#### 检查配置信息

会看到重复的变量名，因为 Git 会从不同的文件中读取同一个配置。

```shell
git config --list [--local|--global|--system]

# 检查某一项的配置
git config <key>

# 重复时可以查看是在哪个文件中配置的该项值
git config --show-origin <key>
```

### 获取帮助

```shell
# 等价
git help <verb>
git <verb> --help
man git-<verb>

# e.g. 获取 git config 命令的手册
git help config
```

如果不需要全面的手册，只需要可用选项的快速参考，那么可以用 -h 选项获得更简明的 「help」 输出。e.g.

```shell
git add -h
```