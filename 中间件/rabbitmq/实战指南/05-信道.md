# 信道

## 概念

1. 每个信道都会被指定一个唯一的ID。
2. 是建立在连接上的虚拟信道。
3. 多线程间复用TCP连接，起到节省作用。

### AMQP协议

#### 协议层

1. Module Layer：协议最高层，定义供客户端调用的命令。
2. Session Layer：
   1. 中间层，负责将客户端的命令发送给服务器，将应答返回给客户端。
   2. 为客户端与服务端之间的通信提供可靠性同步机制和错误处理。
3. Transport Layer：最底层，负责传输二进制数据流。

## 管理

```shell
rabbitmqctl list_channels [channelInfoItem...]
```

默认显示 pid、user、consumer_count、messages_unacknowledged。

1. pid：与连接相关的 `Erlang` 进程 ID。
2. connection：信道所属连接的  `Erlang` 进程 ID。
3. name：信道的名称。
4. number：信道的序号。
5. user：与信道相关的用户名称。
6. vhost：与信道相关的vhost。
7. transactional：信道是否处于事务模式。
8. confirm：信道是否处于 publisher confirm 模式。
9. consumer_count：信道中的消费者的个数。
10. messages_unacknowledged：已投递但是还未被 ack 的消息个数。
11. messages_uncommitted：已接收但是还未提交事务的消息个数。
12. acks_uncommitted：已 ack 收到但是还未提交事务的消息个数。
13. messages_unconfirmed：己发送但是还未确认的消息个数。 如果信道不处于 publisher confmn 模式下 ，则此值为0。
14. perfetch_count：新消费者的 Qos 个数限制。0表示无上限。
15. global_prefetch_count：整个信道的 Qos 个数限制。0表示无上限。